{"version":3,"sources":["../../../client/app/products/products.controller.js"],"names":[],"mappings":"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","file":"products.controller.js","sourcesContent":["'use strict';\n\nvar errorHandler, uploadHander;\n\nangular.module('meanshopApp')\n\n  .controller('ProductsCtrl', function ($scope, Product) {\n    $scope.products = Product.query();\n  })\n\n  .controller('ProductViewCtrl', function ($scope, $state, $stateParams, Product) {\n    $scope.product = Product.get({id: $stateParams.id});\n    $scope.deleteProduct = function(){\n      Product.delete({id: $scope.product._id}, function success(/* value, responseHeaders */) {\n        $state.go('products');\n      }, errorHandler($scope));\n    };\n  })\n\n  .controller('ProductNewCtrl', function ($scope, $state, Product) {\n    $scope.product = {}; // create a new instance\n    $scope.addProduct = function(){\n      Product.save($scope.product, function success(value /*, responseHeaders*/){\n        $state.go('viewProduct', {id: value._id});\n      }, errorHandler($scope));\n    };\n  })\n\n  .controller('ProductEditCtrl', function ($scope, $state, $stateParams, Product, Upload, $timeout) {\n    $scope.product = Product.get({id: $stateParams.id});\n    $scope.editProduct = function(){\n      Product.update({id: $scope.product._id}, $scope.product, function success(value /*, responseHeaders*/){\n        $state.go('viewProduct', {id: value._id});\n      }, errorHandler($scope));\n    };\n\n    $scope.upload = uploadHander($scope, Upload, $timeout);\n  })\n\n  .constant('clientTokenPath', '/api/braintree/client_token')\n\n  .controller('ProductCheckoutCtrl',\n    function($scope, $http, $state, ngCart){\n    $scope.errors = '';\n\n    $scope.paymentOptions = {\n      onPaymentMethodReceived: function(payload) {\n        angular.merge(payload, ngCart.toObject());\n        payload.total = payload.totalCost;\n        $http.post('/api/orders', payload)\n        .then(function success () {\n          ngCart.empty(true);\n          $state.go('products');\n        }, function error (res) {\n          $scope.errors = res;\n        });\n      }\n    };\n  });\n\nerrorHandler = function ($scope){\n  return function error(httpResponse){\n    $scope.errors = httpResponse;\n  };\n};\n\nuploadHander = function ($scope, Upload, $timeout) {\n  return function(file) {\n    if (file && !file.$error) {\n      $scope.file = file;\n      file.upload = Upload.upload({\n        url: '/api/products/'+$scope.product._id+'/upload',\n        file: file\n      });\n\n      file.upload.then(function (response) {\n        $timeout(function () {\n          file.result = response.data;\n        });\n      }, function (response) {\n        if (response.status > 0){\n          console.log(response.status + ': ' + response.data);\n          errorHandler($scope)(response.status + ': ' + response.data);\n        }\n      });\n\n      file.upload.progress(function (evt) {\n        file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));\n      });\n    }\n  };\n};\n"]}